data=read.csv('/Users/rlsdvm/Box Sync/R projects/stifle/stifle/stifledata092518.csv')
data$surgeon=as.character(data$surgeon)
	data$surgeon[which(data$surgeon=='Joyce')]=data$surgeon[which(data$surgeon=='Hendrix')]='resident'
	data$surgeon=as.factor(data$surgeon)

data$lameness_degree[which(data$lameness_degree==0)]=1
	data$lameness_degree[which(data$lameness_degree==5)]=4
	data$lameness_degree=as.factor(data$lameness_degree)

data$discipline=as.character(data$discipline)
	data$discipline[which(data$discipline=='barrel_racing')]=data$discipline[which(data$discipline=='working_cow_horse')]='other'
	data$discipline[which(data$discipline=='roping')]='other';data$discipline[which(data$discipline=='show')]='western_pleasure'
	data$discipline=as.factor(data$discipline)

return=which(data$return_to_work==1)	
	non=which(data$return_to_work==0)	
#categorical: discipline2(4),sex3(3),surgeon5(9),degree9(4),effusion10(4)
#2-level:unilat6,work7,
	#flexion11,osteophytes12,narrow_jt_space13,MFC_SBC14,SBC_TCA15,fibrillation16,partial17,full18,curettage19
	#clefts20,chondromalacia21,meniscal_tear_degen22,fray_tear_cranial23,
	#fray_tear_cruciate24,steroids25,adequan26,irap27,stem_cells28,nsaids29,
	#systemic_suppl30
	#numeric: age4,duration8

summ=matrix(NA,nrow=70,ncol=4)
	colnames(summ)=paste(rep(c('return to work','no return'),each=2),rep(c("N","%"),2))
	rownames(summ)=r=c(paste('discipline:',levels(data$discipline)),
		paste('sex:',levels(data$sex)),'age (mean, sd)',paste('surgeon:',levels(data$surgeon)),
		paste('sides:',levels(data$unilat_bilat)),paste('work:',levels(data$work_or_training)),
		'duration (mean, sd)',paste('lameness_degree:',c('0-1',2,3,'4-5')),paste('effusion:',levels(data$effusion)),
		paste(rep(colnames(data)[11:30],each=2),rep(c('yes','no'),17))
		)
#return,
summ[1,1]=length(which(data[return,]$discipline=='cutting'))
	summ[2,1]=length(which(data[return,]$discipline=='other'))
	summ[3,1]=length(which(data[return,]$discipline=='reining'))
	summ[4,1]=length(which(data[return,]$discipline=='western_pleasure'))
summ[5,1]=length(which(data[return,]$sex=='F'))
	summ[6,1]=length(which(data[return,]$sex=='G'))
	summ[7,1]=length(which(data[return,]$sex=='M'))
summ[8,1]=mean(data[return,]$age,na.rm=TRUE);summ[8,2]=sd(data[return,]$age,na.rm=TRUE)
summ[9,1]=length(which(data[return,]$surgeon=='Baxter'))
	summ[10,1]=length(which(data[return,]$surgeon=='Frisbie'))
	summ[11,1]=length(which(data[return,]$surgeon=='Goodrich'))
	summ[12,1]=length(which(data[return,]$surgeon=='Hendrickson'))
	summ[13,1]=length(which(data[return,]$surgeon=='Hubert'))
	summ[14,1]=length(which(data[return,]$surgeon=='Kawcak'))
	summ[15,1]=length(which(data[return,]$surgeon=='McIlwraith'))
	summ[16,1]=length(which(data[return,]$surgeon=='resident'))
	summ[17,1]=length(which(data[return,]$surgeon=='Trumble'))
summ[18,1]=length(which(data[return,]$unilat_bilat=='bilat'))
	summ[19,1]=length(which(data[return,]$unilat_bilat=='unilat'))
summ[20,1]=length(which(data[return,]$work_or_training=='training'))
	summ[21,1]=length(which(data[return,]$work_or_training=='work'))
summ[22,1]=mean(data[return,]$lameness_duration,na.rm=TRUE);summ[22,2]=sd(data[return,]$lameness_duration,na.rm=TRUE)
summ[23,1]=length(which(data[return,]$lameness_degree==1))
	summ[24,1]=length(which(data[return,]$lameness_degree==2))
	summ[25,1]=length(which(data[return,]$lameness_degree==3))
	summ[26,1]=length(which(data[return,]$lameness_degree==4))
summ[27,1]=length(which(data[return,]$effusion=='0'))
	summ[28,1]=length(which(data[return,]$effusion=='mild'))
	summ[29,1]=length(which(data[return,]$effusion=='moderate'))
	summ[30,1]=length(which(data[return,]$effusion=='severe'))
summ[31,1]=length(which(data[return,]$flexion_response==1))
	summ[32,1]=length(which(data[return,]$flexion_response==0))
summ[33,1]=length(which(data[return,]$osteophytes==1))
	summ[34,1]=length(which(data[return,]$osteophytes==0))
summ[35,1]=length(which(data[return,]$narrow_jt_space==1))
	summ[36,1]=length(which(data[return,]$narrow_jt_space==0))
summ[37,1]=length(which(data[return,]$MFC_SBC==1))
	summ[38,1]=length(which(data[return,]$MFC_SBC==0))
summ[39,1]=length(which(data[return,]$SBC_TCA==1))
	summ[40,1]=length(which(data[return,]$SBC_TCA==0))
summ[41,1]=length(which(data[return,]$cartilage_fibrillation==1))
	summ[42,1]=length(which(data[return,]$cartilage_fibrillation==0))
summ[43,1]=length(which(data[return,]$cart_lesion_partial==1))
	summ[44,1]=length(which(data[return,]$cart_lesion_partial==0))
summ[45,1]=length(which(data[return,]$cart_lesion_full==1))
	summ[46,1]=length(which(data[return,]$cart_lesion_full==0))
summ[47,1]=length(which(data[return,]$micropicking_curettage==1))
	summ[48,1]=length(which(data[return,]$micropicking_curettage==0))
summ[49,1]=length(which(data[return,]$cart_clefts==1))
	summ[50,1]=length(which(data[return,]$cart_clefts==0))
summ[51,1]=length(which(data[return,]$chondromalacia==1))
	summ[52,1]=length(which(data[return,]$chondromalacia==0))
summ[53,1]=length(which(data[return,]$meniscal_tear_degen==1))
	summ[54,1]=length(which(data[return,]$meniscal_tear_degen==0))
summ[55,1]=length(which(data[return,]$fray_tear_cranial_meniscotibial_lig==1))
	summ[56,1]=length(which(data[return,]$fray_tear_cranial_meniscotibial_lig==0))
summ[57,1]=length(which(data[return,]$fray_tear_cruciate_lig==1))
	summ[58,1]=length(which(data[return,]$fray_tear_cruciate_lig==0))
summ[59,1]=length(which(data[return,]$steroids==1))
	summ[60,1]=length(which(data[return,]$steroids==0))
summ[61,1]=length(which(data[return,]$ha_adequan==1))
	summ[62,1]=length(which(data[return,]$ha_adequan==0))
summ[63,1]=length(which(data[return,]$irap==1))
	summ[64,1]=length(which(data[return,]$irap==0))
summ[65,1]=length(which(data[return,]$stem_cells==1))
	summ[66,1]=length(which(data[return,]$stem_cells==0))
summ[67,1]=length(which(data[return,]$nsaids==1))
	summ[68,1]=length(which(data[return,]$nsaids==0))
summ[69,1]=length(which(data[return,]$systemic_suppl==1))
	summ[70,1]=length(which(data[return,]$systemic_suppl==0))

#non-return
	#return,
	summ[1,3]=length(which(data[non,]$discipline=='cutting'))
	summ[2,3]=length(which(data[non,]$discipline=='other'))
	summ[3,3]=length(which(data[non,]$discipline=='reining'))
	summ[4,3]=length(which(data[non,]$discipline=='western_pleasure'))
	summ[5,3]=length(which(data[non,]$sex=='F'))
	summ[6,3]=length(which(data[non,]$sex=='G'))
	summ[7,3]=length(which(data[non,]$sex=='M'))
	summ[8,3]=mean(data[non,]$age,na.rm=TRUE);summ[8,3]=sd(data[non,]$age,na.rm=TRUE)
	summ[9,3]=length(which(data[non,]$surgeon=='Baxter'))
	summ[10,3]=length(which(data[non,]$surgeon=='Frisbie'))
	summ[11,3]=length(which(data[non,]$surgeon=='Goodrich'))
	summ[12,3]=length(which(data[non,]$surgeon=='Hendrickson'))
	summ[13,3]=length(which(data[non,]$surgeon=='Hubert'))
	summ[14,3]=length(which(data[non,]$surgeon=='Kawcak'))
	summ[15,3]=length(which(data[non,]$surgeon=='McIlwraith'))
	summ[16,3]=length(which(data[non,]$surgeon=='resident'))
	summ[17,3]=length(which(data[non,]$surgeon=='Trumble'))
	summ[18,3]=length(which(data[non,]$unilat_bilat=='bilat'))
	summ[19,3]=length(which(data[non,]$unilat_bilat=='unilat'))
	summ[20,3]=length(which(data[non,]$work_or_training=='training'))
	summ[21,3]=length(which(data[non,]$work_or_training=='work'))
	summ[22,3]=mean(data[non,]$lameness_duration,na.rm=TRUE);summ[22,3]=sd(data[non,]$lameness_duration,na.rm=TRUE)
	summ[23,3]=length(which(data[non,]$lameness_degree==1))
	summ[24,3]=length(which(data[non,]$lameness_degree==2))
	summ[25,3]=length(which(data[non,]$lameness_degree==3))
	summ[26,3]=length(which(data[non,]$lameness_degree==4))
	summ[27,3]=length(which(data[non,]$effusion=='0'))
	summ[28,3]=length(which(data[non,]$effusion=='mild'))
	summ[29,3]=length(which(data[non,]$effusion=='moderate'))
	summ[30,3]=length(which(data[non,]$effusion=='severe'))
	summ[31,3]=length(which(data[non,]$flexion_response==1))
	summ[32,3]=length(which(data[non,]$flexion_response==0))
	summ[33,3]=length(which(data[non,]$osteophytes==1))
	summ[34,3]=length(which(data[non,]$osteophytes==0))
	summ[35,3]=length(which(data[non,]$narrow_jt_space==1))
	summ[36,3]=length(which(data[non,]$narrow_jt_space==0))
	summ[37,3]=length(which(data[non,]$MFC_SBC==1))
	summ[38,3]=length(which(data[non,]$MFC_SBC==0))
	summ[39,3]=length(which(data[non,]$SBC_TCA==1))
	summ[40,3]=length(which(data[non,]$SBC_TCA==0))
	summ[41,3]=length(which(data[non,]$cartilage_fibrillation==1))
	summ[42,3]=length(which(data[non,]$cartilage_fibrillation==0))
	summ[43,3]=length(which(data[non,]$cart_lesion_partial==1))
	summ[44,3]=length(which(data[non,]$cart_lesion_partial==0))
	summ[45,3]=length(which(data[non,]$cart_lesion_full==1))
	summ[46,3]=length(which(data[non,]$cart_lesion_full==0))
	summ[47,3]=length(which(data[non,]$micropicking_curettage==1))
	summ[48,3]=length(which(data[non,]$micropicking_curettage==0))
	summ[49,3]=length(which(data[non,]$cart_clefts==1))
	summ[50,3]=length(which(data[non,]$cart_clefts==0))
	summ[51,3]=length(which(data[non,]$chondromalacia==1))
	summ[52,3]=length(which(data[non,]$chondromalacia==0))
	summ[53,3]=length(which(data[non,]$meniscal_tear_degen==1))
	summ[54,3]=length(which(data[non,]$meniscal_tear_degen==0))
	summ[55,3]=length(which(data[non,]$fray_tear_cranial_meniscotibial_lig==1))
	summ[56,3]=length(which(data[non,]$fray_tear_cranial_meniscotibial_lig==0))
	summ[57,3]=length(which(data[non,]$fray_tear_cruciate_lig==1))
	summ[58,3]=length(which(data[non,]$fray_tear_cruciate_lig==0))
	summ[59,3]=length(which(data[non,]$steroids==1))
	summ[60,3]=length(which(data[non,]$steroids==0))
	summ[61,3]=length(which(data[non,]$ha_adequan==1))
	summ[62,3]=length(which(data[non,]$ha_adequan==0))
	summ[63,3]=length(which(data[non,]$irap==1))
	summ[64,3]=length(which(data[non,]$irap==0))
	summ[65,3]=length(which(data[non,]$stem_cells==1))
	summ[66,3]=length(which(data[non,]$stem_cells==0))
	summ[67,3]=length(which(data[non,]$nsaids==1))
	summ[68,3]=length(which(data[non,]$nsaids==0))
	summ[69,3]=length(which(data[non,]$systemic_suppl==1))
	summ[70,3]=length(which(data[non,]$systemic_suppl==0))
	

#%
cols=c(1:7,9:21,23:70)
summ[cols,2]=summ[cols,1]/length(return)*100
summ[cols,4]=summ[cols,3]/length(non)*100

summ=round(summ,0)

save(summ,file='summary_for_stifle_data_20180925.R')
write.csv(summ,file='summary_for_stifle_data_20180925.csv')
